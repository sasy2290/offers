<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>TechAndMore ‚Äì Offerte Amazon aggiornate automaticamente</title>
    <meta name="description"
          content="TechAndMore raccoglie automaticamente le migliori offerte Amazon dai principali canali Telegram italiani e le mostra in un'unica pagina filtrabile." />

    <!-- Open Graph / Social -->
    <meta property="og:title" content="TechAndMore ‚Äì Offerte Amazon" />
    <meta property="og:description"
          content="Offerte Amazon aggiornate automaticamente da pi√π canali Telegram. Nessuna registrazione, solo offerte." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://techandmore.eu/" />
    <meta property="og:image" content="https://techandmore.eu/img/cover-techandmore.jpg" />
    <meta property="og:site_name" content="TechAndMore" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="TechAndMore ‚Äì Offerte Amazon" />
    <meta name="twitter:description"
          content="Le migliori offerte Amazon dai principali canali Telegram, in una sola pagina." />
    <meta name="twitter:image" content="https://techandmore.eu/img/cover-techandmore.jpg" />

    <style>
        :root {
            color-scheme: dark;
            --bg-main: #050b16;
            --bg-elevated: #0d1117;
            --bg-card: #111827;
            --accent: #00a2ff;
            --accent-soft: #0091e6;
            --accent-warm: #ff8a00;
            --text-main: #f9fafb;
            --text-muted: #9ca3af;
            --border-subtle: #1f2933;
            --radius-lg: 14px;
            --shadow-soft: 0 18px 45px rgba(0, 0, 0, 0.55);
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: radial-gradient(circle at top, #07152b 0, #050b16 45%, #02040a 100%);
            color: var(--text-main);
        }

        a {
            color: inherit;
            text-decoration: none;
        }

        /* HEADER */

        .navbar {
            position: sticky;
            top: 0;
            z-index: 40;
            backdrop-filter: blur(18px);
            background:
                linear-gradient(
                    120deg,
                    rgba(0, 162, 255, 0.08),
                    rgba(255, 138, 0, 0.05)
                )
                border-box;
            border-bottom: 1px solid rgba(15, 23, 42, 0.9);
        }

        .nav-inner {
            max-width: 1200px;
            margin: 0 auto;
            padding: 10px 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
        }

        .nav-left {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo img {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            box-shadow: 0 0 18px rgba(0, 162, 255, 0.65);
            object-fit: cover;
        }

        .logo-text-main {
            font-size: 22px;
            font-weight: 800;
            letter-spacing: 0.04em;
            color: var(--accent);
        }

        .logo-text-sub {
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.14em;
            color: var(--text-muted);
        }

        .nav-links {
            display: flex;
            align-items: center;
            gap: 18px;
            font-size: 14px;
        }

        .nav-link {
            padding: 6px 0;
            position: relative;
            color: var(--text-muted);
        }

        .nav-link:hover,
        .nav-link.active {
            color: var(--text-main);
        }

        .nav-link.active::after {
            content: "";
            position: absolute;
            left: 0;
            right: 0;
            bottom: -4px;
            height: 2px;
            border-radius: 999px;
            background: linear-gradient(90deg, var(--accent), var(--accent-warm));
        }

        .nav-social {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .social-pill {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 10px;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.25);
            font-size: 11px;
            color: var(--text-muted);
            background: rgba(15, 23, 42, 0.75);
        }

        .social-dot {
            width: 7px;
            height: 7px;
            border-radius: 999px;
            background: var(--accent);
        }

        .social-pill:hover {
            border-color: var(--accent);
            color: var(--text-main);
        }

        .social-icon {
            width: 18px;
            height: 18px;
            border-radius: 999px;
            background: rgba(15, 23, 42, 0.9);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
        }

        .nav-toggle {
            display: none;
        }

        @media (max-width: 720px) {
            .nav-links {
                display: none;
            }

            .nav-social {
                display: none;
            }

            .nav-toggle {
                display: inline-flex;
                width: 32px;
                height: 32px;
                align-items: center;
                justify-content: center;
                border-radius: 999px;
                border: 1px solid rgba(148, 163, 184, 0.25);
                background: rgba(15, 23, 42, 0.9);
                font-size: 17px;
            }

            .nav-toggle-menu {
                position: fixed;
                inset: 52px 10px auto 10px;
                background: #020617;
                border-radius: 18px;
                border: 1px solid rgba(15, 23, 42, 0.9);
                padding: 14px;
                box-shadow: 0 24px 60px rgba(0, 0, 0, 0.85);
                display: none;
                flex-direction: column;
                gap: 10px;
            }

            .nav-toggle-menu.open {
                display: flex;
            }

            .nav-toggle-menu .nav-links {
                display: flex;
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }

            .nav-toggle-menu .nav-social {
                display: flex;
                margin-top: 6px;
                flex-wrap: wrap;
            }
        }

        /* HERO */

        .hero {
            max-width: 1200px;
            margin: 14px auto 0;
            padding: 0 16px 18px;
        }

        .hero-inner {
            position: relative;
            overflow: hidden;
            border-radius: 26px;
            background:
                radial-gradient(circle at 4% 0, rgba(0, 162, 255, 0.2), transparent 55%),
                radial-gradient(circle at 98% 0, rgba(255, 138, 0, 0.2), transparent 50%),
                linear-gradient(135deg, #020617, #020617);
            border: 1px solid rgba(15, 23, 42, 0.9);
            box-shadow: var(--shadow-soft);
        }

        .hero-grid {
            display: grid;
            grid-template-columns: minmax(0, 5fr) minmax(0, 7fr);
            gap: 20px;
            padding: 22px 22px 18px;
        }

        @media (max-width: 840px) {
            .hero-grid {
                grid-template-columns: minmax(0, 1fr);
                padding: 18px 16px 16px;
            }
        }

        .hero-copy-eyebrow {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 4px 9px 4px 4px;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.35);
            background: rgba(15, 23, 42, 0.8);
            font-size: 11px;
            color: var(--text-muted);
            margin-bottom: 8px;
        }

        .hero-chip {
            border-radius: 999px;
            padding: 3px 9px;
            font-size: 11px;
            background: rgba(0, 162, 255, 0.15);
            color: var(--accent);
        }

        .hero-title {
            font-size: clamp(28px, 4vw, 34px);
            font-weight: 800;
            margin: 4px 0 6px;
            letter-spacing: 0.03em;
        }

        .hero-subtitle {
            font-size: 14px;
            color: var(--text-muted);
            max-width: 420px;
        }

        .hero-kpi-row {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            margin-top: 14px;
        }

        .hero-kpi {
            font-size: 12px;
            color: var(--text-muted);
        }

        .hero-kpi strong {
            display: block;
            font-size: 15px;
            color: var(--accent);
        }

        .hero-cta-row {
            margin-top: 16px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .btn-primary {
            padding: 9px 16px;
            border-radius: 999px;
            border: none;
            background: linear-gradient(135deg, var(--accent), var(--accent-warm));
            color: #0b1120;
            font-weight: 600;
            font-size: 13px;
            cursor: pointer;
        }

        .btn-primary:hover {
            filter: brightness(1.05);
        }

        .btn-ghost {
            padding: 8px 14px;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.4);
            background: rgba(15, 23, 42, 0.9);
            color: var(--text-main);
            font-size: 13px;
            cursor: pointer;
        }

        .btn-ghost:hover {
            border-color: var(--accent);
        }

        .hero-media {
            position: relative;
        }

        .hero-media-card {
            position: relative;
            border-radius: 22px;
            overflow: hidden;
            border: 1px solid rgba(15, 23, 42, 0.9);
            background: radial-gradient(circle at top, rgba(0, 162, 255, 0.12), transparent 40%),
            rgba(15, 23, 42, 0.9);
            min-height: 180px;
        }

        .hero-cover {
            width: 100%;
            height: 100%;
            min-height: 180px;
            object-fit: cover;
            opacity: 0.9;
        }

        .hero-logo-badge {
            position: absolute;
            left: 18px;
            bottom: 18px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 6px 10px;
            border-radius: 999px;
            background: rgba(15, 23, 42, 0.92);
            border: 1px solid rgba(148, 163, 184, 0.35);
            font-size: 11px;
            color: var(--text-muted);
        }

        .hero-logo-badge img {
            width: 22px;
            height: 22px;
            border-radius: 999px;
        }

        /* TOOLBAR FILTRI */

        .toolbar {
            max-width: 1200px;
            margin: 0 auto;
            padding: 6px 16px 12px;
        }

        .toolbar-inner {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
            justify-content: space-between;
        }

        .toolbar-left {
            flex: 1 1 220px;
            min-width: 0;
        }

        .search-box {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 7px 10px;
            border-radius: 999px;
            background: var(--bg-elevated);
            border: 1px solid var(--border-subtle);
        }

        .search-box input {
            flex: 1;
            border: none;
            background: transparent;
            color: var(--text-main);
            font-size: 13px;
            outline: none;
        }

        .search-icon {
            font-size: 14px;
            color: var(--text-muted);
        }

        .toolbar-right {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .select-wrap select {
            appearance: none;
            padding: 6px 28px 6px 10px;
            border-radius: 999px;
            border: 1px solid var(--border-subtle);
            background: var(--bg-elevated);
            color: var(--text-muted);
            font-size: 12px;
            outline: none;
        }

        .select-wrap {
            position: relative;
        }

        .select-wrap::after {
            content: "‚ñæ";
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 10px;
            color: var(--text-muted);
            pointer-events: none;
        }

        .pill-filters {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 16px 10px;
        }

        .pill-row {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .pill {
            padding: 5px 11px;
            border-radius: 999px;
            border: 1px solid var(--border-subtle);
            background: rgba(15, 23, 42, 0.92);
            font-size: 12px;
            color: var(--text-muted);
            cursor: pointer;
        }

        .pill.active {
            background: rgba(0, 162, 255, 0.16);
            border-color: var(--accent);
            color: var(--accent);
        }

        /* LISTA OFFERTE */

        .section-title {
            max-width: 1200px;
            margin: 6px auto 4px;
            padding: 0 16px;
            font-size: 18px;
            font-weight: 700;
        }

        .offers-container {
            max-width: 1200px;
            margin: 0 auto 40px;
            padding: 0 16px 20px;
        }

        .offers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 18px;
        }

        .offer-card {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            border: 1px solid rgba(15, 23, 42, 0.95);
            box-shadow: var(--shadow-soft);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            min-height: 100%;
        }

        .offer-thumb-wrap {
            position: relative;
            background: #020617;
        }

        .offer-thumb {
            width: 100%;
            height: 200px;
            object-fit: contain;
            padding: 10px;
            background: radial-gradient(circle at top, rgba(0, 162, 255, 0.15), transparent 60%);
        }

        .offer-badge {
            position: absolute;
            left: 10px;
            top: 10px;
            padding: 4px 8px;
            border-radius: 999px;
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.12em;
            background: rgba(15, 23, 42, 0.92);
            border: 1px solid rgba(148, 163, 184, 0.45);
            color: var(--accent);
        }

        .offer-body {
            padding: 10px 12px 12px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .offer-title {
            font-size: 14px;
            line-height: 1.35;
        }

        .offer-meta {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            gap: 8px;
        }

        .offer-price {
            font-size: 18px;
            font-weight: 700;
            color: var(--accent-warm);
        }

        .offer-tagline {
            font-size: 11px;
            color: var(--text-muted);
        }

        .offer-actions {
            margin-top: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 8px;
        }

        .offer-link-btn {
            flex: 1;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            padding: 7px 10px;
            border-radius: 999px;
            font-size: 13px;
            font-weight: 600;
            border: none;
            background: linear-gradient(135deg, var(--accent), var(--accent-soft));
            color: #020617;
            cursor: pointer;
        }

        .offer-link-btn span {
            font-size: 14px;
        }

        .status {
            text-align: center;
            margin: 18px 0 6px;
            font-size: 13px;
            color: var(--text-muted);
        }

        .load-more-wrap {
            text-align: center;
            margin-top: 8px;
        }

        .btn-load-more {
            padding: 8px 16px;
            border-radius: 999px;
            border: 1px solid rgba(148, 163, 184, 0.45);
            background: rgba(15, 23, 42, 0.96);
            color: var(--text-main);
            font-size: 13px;
            cursor: pointer;
        }

        .btn-load-more:hover {
            border-color: var(--accent);
        }

        /* FOOTER */

        footer {
            border-top: 1px solid rgba(15, 23, 42, 0.9);
            background: #020617;
        }

        .footer-inner {
            max-width: 1200px;
            margin: 0 auto;
            padding: 14px 16px 18px;
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            align-items: center;
            justify-content: space-between;
            font-size: 11px;
            color: var(--text-muted);
        }

        .footer-links {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .footer-links a {
            color: var(--accent);
        }
    </style>
</head>
<body>

<header class="navbar">
    <div class="nav-inner">
        <div class="nav-left">
            <a href="#top" class="logo">
                <img src="img/logo-techandmore.png" alt="TechAndMore logo" />
                <div>
                    <div class="logo-text-main">TechAndMore</div>
                    <div class="logo-text-sub">Offerte Amazon</div>
                </div>
            </a>
        </div>

        <nav class="nav-links">
            <a href="#offers" class="nav-link active">Ultime offerte</a>
            <a href="#how-it-works" class="nav-link">Come funziona</a>
        </nav>

        <div class="nav-social">
            <a href="https://t.me/amazontechandmore" target="_blank" rel="noopener" class="social-pill">
                <span class="social-dot"></span> Telegram
            </a>
            <a href="https://www.facebook.com/profile.php?id=61584285477955" target="_blank" rel="noopener" class="social-pill">
                <span class="social-icon">f</span> Pagina
            </a>
            <a href="https://www.instagram.com/techandmore.eu/" target="_blank" rel="noopener" class="social-pill">
                <span class="social-icon">IG</span>
            </a>
        </div>

        <button class="nav-toggle" id="navToggle" aria-label="Menu">
            ‚ò∞
        </button>
    </div>

    <div class="nav-toggle-menu" id="navToggleMenu">
        <nav class="nav-links">
            <a href="#offers" class="nav-link active">Ultime offerte</a>
            <a href="#how-it-works" class="nav-link">Come funziona</a>
        </nav>
        <div class="nav-social">
            <a href="https://t.me/amazontechandmore" target="_blank" rel="noopener" class="social-pill">
                <span class="social-dot"></span> Telegram
            </a>
            <a href="https://www.facebook.com/profile.php?id=61584285477955" target="_blank" rel="noopener" class="social-pill">
                <span class="social-icon">f</span> Pagina
            </a>
            <a href="https://www.instagram.com/techandmore.eu/" target="_blank" rel="noopener" class="social-pill">
                <span class="social-icon">IG</span>
            </a>
        </div>
    </div>
</header>

<main id="top">
    <!-- HERO -->
    <section class="hero">
        <div class="hero-inner">
            <div class="hero-grid">
                <div class="hero-copy">
                    <div class="hero-copy-eyebrow">
                        üî•
                        <span>Offerte aggiornate automaticamente</span>
                        <span class="hero-chip">Amazon.it</span>
                    </div>
                    <h1 class="hero-title">Le migliori offerte Amazon, senza cercarle.</h1>
                    <p class="hero-subtitle">
                        TechAndMore raccoglie in automatico le promo dai principali canali Telegram
                        e le rende cliccabili in un‚Äôunica pagina leggera e veloce.
                    </p>

                    <div class="hero-kpi-row">
                        <div class="hero-kpi">
                            <strong id="kpi-offers">‚Äì</strong>
                            offerte trovate di recente
                        </div>
                        <div class="hero-kpi">
                            <strong>24/7</strong>
                            aggiornamento automatico
                        </div>
                        <div class="hero-kpi">
                            <strong>0 ‚Ç¨</strong>
                            servizio gratuito
                        </div>
                    </div>

                    <div class="hero-cta-row">
                        <a href="#offers"><button class="btn-primary">Vedi le ultime offerte</button></a>
                        <a href="#how-it-works"><button class="btn-ghost">Come funziona</button></a>
                    </div>
                </div>

                <div class="hero-media">
                    <div class="hero-media-card">
                        <img src="img/cover-techandmore.jpg" alt="TechAndMore" class="hero-cover" />
                        <div class="hero-logo-badge">
                            <img src="img/logo-techandmore.png" alt="TechAndMore" />
                            <span>TechAndMore ‚Ä¢ Amazon deals</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- TOOLBAR / FILTRI -->
    <section class="toolbar">
        <div class="toolbar-inner">
            <div class="toolbar-left">
                <div class="search-box">
                    <span class="search-icon">üîç</span>
                    <input type="text" id="searchInput" placeholder="Cerca per nome prodotto, brand, categoria‚Ä¶" />
                </div>
            </div>
            <div class="toolbar-right">
                <div class="select-wrap">
                    <select id="categorySelect">
                        <option value="all">Tutte le categorie</option>
                    </select>
                </div>
                <div class="select-wrap">
                    <select id="sortSelect">
                        <option value="newest">Pi√π recenti</option>
                        <option value="price-asc">Prezzo crescente</option>
                        <option value="price-desc">Prezzo decrescente</option>
                    </select>
                </div>
            </div>
        </div>
    </section>

    <section class="pill-filters">
        <div class="pill-row" id="quickFilters">
            <button class="pill active" data-cat="all">Tutte</button>
            <button class="pill" data-cat="Tecnologia">Tecnologia</button>
            <button class="pill" data-cat="Casa">Casa</button>
            <button class="pill" data-cat="Moda">Moda</button>
            <button class="pill" data-cat="Altro">Altro</button>
        </div>
    </section>

    <!-- LISTA OFFERTE -->
    <section aria-labelledby="offers-heading">
        <h2 class="section-title" id="offers-heading">Ultime offerte</h2>

        <div class="status" id="status">Caricamento offerte‚Ä¶</div>

        <div class="offers-container">
            <div class="offers-grid" id="offersGrid"></div>
            <div class="load-more-wrap">
                <button class="btn-load-more" id="loadMoreBtn" style="display: none;">
                    Carica altre offerte
                </button>
            </div>
        </div>
    </section>

    <!-- COME FUNZIONA -->
    <section id="how-it-works">
        <div class="offers-container">
            <h2 class="section-title">Come funziona TechAndMore</h2>
            <p style="font-size: 13px; color: var(--text-muted); margin-bottom: 10px;">
                1. Un bot legge periodicamente i principali canali Telegram di offerte italiane.<br />
                2. I link Amazon vengono ‚Äúripuliti‚Äù e convertiti con il nostro tag affiliato.<br />
                3. Le offerte vengono pubblicate sul canale Telegram
                <a href="https://t.me/amazontechandmore" target="_blank" rel="noopener" style="color: var(--accent);">amazontechandmore</a>,
                sulla pagina Facebook e su questo sito.<br />
                4. L‚Äôelenco qui sopra si aggiorna in automatico: nessun login, nessuna registrazione.
            </p>
            <p style="font-size: 12px; color: var(--text-muted);">
                Alcuni link sono link di affiliazione: per te il prezzo non cambia, ma una piccola commissione
                aiuta a mantenere il progetto senza costi per gli utenti.
            </p>
        </div>
    </section>
</main>

<footer>
    <div class="footer-inner">
        <div>¬© <span id="year"></span> TechAndMore ‚Äì Offerte Amazon automatiche.</div>
        <div class="footer-links">
            <a href="https://t.me/amazontechandmore" target="_blank" rel="noopener">Telegram</a>
            <span>¬∑</span>
            <a href="https://www.facebook.com/profile.php?id=61584285477955" target="_blank" rel="noopener">Facebook</a>
            <span>¬∑</span>
            <a href="https://www.instagram.com/techandmore.eu/" target="_blank" rel="noopener">Instagram</a>
        </div>
    </div>
</footer>

<script>
    const PAGE_SIZE = 24;
    let allOffers = [];
    let filteredOffers = [];
    let currentPage = 1;

    const statusEl = document.getElementById("status");
    const offersGrid = document.getElementById("offersGrid");
    const loadMoreBtn = document.getElementById("loadMoreBtn");
    const searchInput = document.getElementById("searchInput");
    const categorySelect = document.getElementById("categorySelect");
    const sortSelect = document.getElementById("sortSelect");
    const quickFilters = document.getElementById("quickFilters");
    const kpiOffers = document.getElementById("kpi-offers");

    // Navbar mobile
    const navToggle = document.getElementById("navToggle");
    const navToggleMenu = document.getElementById("navToggleMenu");
    if (navToggle) {
        navToggle.addEventListener("click", () => {
            navToggleMenu.classList.toggle("open");
        });
    }

    document.getElementById("year").textContent = new Date().getFullYear();

    function parsePrice(str) {
        if (!str) return null;
        const match = String(str).replace(",", ".").match(/(\d+(\.\d+)?)/);
        return match ? parseFloat(match[1]) : null;
    }

    function inferCategory(title) {
        const t = (title || "").toLowerCase();
        if (t.match(/ssd|hdd|monitor|mouse|tastiera|pc|gaming|router|chiavetta|usb|smartphone|tablet|notebook|tv|stampante|scheda/i)) {
            return "Tecnologia";
        }
        if (t.match(/aspirapolvere|cucina|padella|forno|copripiumino|cuscino|lampada|sedia|divano|tovaglia|letto|armadio|moka|tenda|coperta|piumone|bagn/i)) {
            return "Casa";
        }
        if (t.match(/scarpe|maglia|felpa|pantaloni|jeans|giacca|cappotto|t-shirt|polo|abito|vestito|bikini|reggiseno|leggins|tuta|calze/i)) {
            return "Moda";
        }
        return "Altro";
    }

    function normalizeOffer(raw) {
        const priceValue = parsePrice(raw.price);
        const category = raw.category || inferCategory(raw.title);
        const source = raw.source || "Amazon.it";
        return {
            title: raw.title || "Offerta Amazon",
            url: raw.url || "https://www.amazon.it/",
            price: raw.price || "",
            priceValue,
            image: raw.image ||
                "https://upload.wikimedia.org/wikipedia/commons/a/a9/Amazon_logo.svg",
            category,
            source,
        };
    }

    function renderCategoryOptions() {
        const cats = Array.from(new Set(allOffers.map(o => o.category))).sort();
        categorySelect.innerHTML = '<option value="all">Tutte le categorie</option>';
        cats.forEach(cat => {
            const opt = document.createElement("option");
            opt.value = cat;
            opt.textContent = cat;
            categorySelect.appendChild(opt);
        });
    }

    function applyFilters() {
        const search = searchInput.value.trim().toLowerCase();
        const cat = categorySelect.value;
        const quickActive = quickFilters.querySelector(".pill.active");
        const quickCat = quickActive ? quickActive.getAttribute("data-cat") : "all";

        filteredOffers = allOffers.filter(o => {
            if (cat !== "all" && o.category !== cat) return false;
            if (quickCat !== "all" && o.category !== quickCat) return false;

            if (search) {
                const txt = (o.title || "").toLowerCase();
                return txt.includes(search);
            }
            return true;
        });

        const sort = sortSelect.value;
        if (sort === "price-asc") {
            filteredOffers.sort((a, b) => (a.priceValue || 1e9) - (b.priceValue || 1e9));
        } else if (sort === "price-desc") {
            filteredOffers.sort((a, b) => (b.priceValue || -1) - (a.priceValue || -1));
        } // "newest" mantiene l'ordine del JSON

        currentPage = 1;
        renderOffers();
    }

    function renderOffers() {
        offersGrid.innerHTML = "";

        if (!filteredOffers.length) {
            statusEl.textContent = "Nessuna offerta trovata con questi filtri.";
            loadMoreBtn.style.display = "none";
            return;
        }

        statusEl.textContent = "";

        const end = currentPage * PAGE_SIZE;
        const visible = filteredOffers.slice(0, end);

        visible.forEach(o => {
            const card = document.createElement("article");
            card.className = "offer-card";

            const thumbWrap = document.createElement("div");
            thumbWrap.className = "offer-thumb-wrap";

            const img = document.createElement("img");
            img.className = "offer-thumb";
            img.src = o.image;
            img.alt = o.title;
            img.loading = "lazy";
            img.onerror = () => {
                img.src =
                    "https://upload.wikimedia.org/wikipedia/commons/a/a9/Amazon_logo.svg";
            };

            const badge = document.createElement("div");
            badge.className = "offer-badge";
            badge.textContent = o.category;

            thumbWrap.appendChild(img);
            thumbWrap.appendChild(badge);

            const body = document.createElement("div");
            body.className = "offer-body";

            const title = document.createElement("h3");
            title.className = "offer-title";
            title.textContent = o.title;

            const meta = document.createElement("div");
            meta.className = "offer-meta";

            const price = document.createElement("div");
            price.className = "offer-price";
            price.textContent = o.price || "";

            const tagline = document.createElement("div");
            tagline.className = "offer-tagline";
            tagline.textContent = o.source;

            meta.appendChild(price);
            meta.appendChild(tagline);

            const actions = document.createElement("div");
            actions.className = "offer-actions";

            const btn = document.createElement("a");
            btn.href = o.url;
            btn.target = "_blank";
            btn.rel = "noopener noreferrer";
            btn.className = "offer-link-btn";
            btn.innerHTML = "<span>üõí</span> Vai all'offerta";

            actions.appendChild(btn);

            body.appendChild(title);
            body.appendChild(meta);
            body.appendChild(actions);

            card.appendChild(thumbWrap);
            card.appendChild(body);

            offersGrid.appendChild(card);
        });

        if (end < filteredOffers.length) {
            loadMoreBtn.style.display = "inline-block";
        } else {
            loadMoreBtn.style.display = "none";
        }
    }

    async function loadOffers() {
        try {
            statusEl.textContent = "Caricamento offerte‚Ä¶";
            const res = await fetch("latest_offers.json?ts=" + Date.now());
            if (!res.ok) {
                throw new Error("HTTP " + res.status);
            }

            const data = await res.json();
            if (!Array.isArray(data) || data.length === 0) {
                statusEl.textContent = "Nessuna offerta disponibile al momento.";
                return;
            }

            allOffers = data.map(normalizeOffer);
            kpiOffers.textContent = allOffers.length.toString();

            renderCategoryOptions();
            applyFilters();
        } catch (e) {
            console.error(e);
            statusEl.textContent = "Errore nel caricamento delle offerte.";
        }
    }

    // Event listeners
    searchInput.addEventListener("input", applyFilters);
    categorySelect.addEventListener("change", applyFilters);
    sortSelect.addEventListener("change", applyFilters);
    quickFilters.addEventListener("click", e => {
        if (e.target.classList.contains("pill")) {
            quickFilters.querySelectorAll(".pill").forEach(p =>
                p.classList.toggle("active", p === e.target)
            );
            applyFilters();
        }
    });
    loadMoreBtn.addEventListener("click", () => {
        currentPage += 1;
        renderOffers();
    });

    loadOffers();
</script>

</body>
</html>
